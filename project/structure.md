# Структура проекта

```
idex/
├── src/
│   ├── app/                      # Страницы Next.js приложения
│   │   ├── admin/                # Страница администратора
│   │   ├── login/                # Страница входа
│   │   ├── profile/              # Страница профиля пользователя
│   │   ├── register/             # Страница регистрации
│   │   └── page.tsx              # Главная страница
│   │
│   ├── components/               # Компоненты React
│   │   ├── auth/                 # Компоненты аутентификации
│   │   │   ├── activate-form.tsx # Форма активации аккаунта
│   │   │   ├── auth-tabs.tsx     # Компонент с вкладками авторизация/регистрация
│   │   │   ├── login-form.tsx    # Форма входа
│   │   │   └── register-form.tsx # Форма регистрации
│   │   └── navigation.tsx        # Навигационная панель
│   │
│   ├── lib/                      # Утилиты и хранилища
│   │   └── stores/               # Хранилища состояний Zustand
│   │       └── auth-store.ts     # Хранилище состояния аутентификации
│   │
│   ├── providers/                # Провайдеры контекста
│   │   ├── auth-provider.tsx     # Провайдер аутентификации
│   │   └── theme-provider.tsx    # Провайдер темы оформления
│   │
│   ├── server/                   # Серверная часть
│   │   └── api/                  # tRPC API
│   │       ├── routers/          # Маршрутизаторы API
│   │       │   └── auth.ts       # Маршрутизатор для аутентификации
│   │       ├── root.ts           # Корневой маршрутизатор tRPC
│   │       └── trpc.ts           # Настройка tRPC
│   │
│   └── trpc/                     # Клиентская настройка tRPC
│
├── prisma/                      # Настройки Prisma ORM
│   └── schema.prisma            # Схема базы данных
│
└── project/                     # Документация проекта
    ├── history.md               # История изменений проекта
    ├── structure.md             # Этот файл - структура проекта
    ├── tech.md                  # Используемые технологии
    └── requests.md              # Архив запросов и ответов

## Функциональное описание

### Страницы

- **Главная страница (/)**: Приветственное сообщение и кнопки для регистрации и входа
- **Страница входа (/login)**: Форма входа в систему с валидацией 
- **Страница регистрации (/register)**: Форма регистрации с валидацией и проверкой пароля
- **Страница профиля (/profile)**: Отображение информации о пользователе и форма активации для гостевых аккаунтов
- **Страница администратора (/admin)**: Управление пользователями и генерация ключей активации

### Компоненты

- **AuthTabs**: Переключение между вкладками входа и регистрации
- **LoginForm**: Форма для входа в систему с валидацией Zod
- **RegisterForm**: Форма для регистрации пользователей с валидацией и проверкой пароля
- **ActivateForm**: Форма для активации аккаунта с использованием ключа активации
- **Navigation**: Навигационная панель с адаптивным дизайном и переключателем темы

### Компоненты аутентификации

### Хранилище состояний аутентификации 
- `src/lib/stores/auth-store.ts` - Реализация Zustand-хранилища для управления состоянием аутентификации.
  - **Методы**:
    - `login(email, password)` - Аутентификация пользователя с обработкой ошибок и состояний загрузки
    - `register(name, email, password)` - Регистрация нового пользователя
    - `logout()` - Выход из системы и очистка состояния
    - `activateAccount(key)` - Активация аккаунта через ключ 
    - `fetchProfile()` - Получение данных профиля авторизованного пользователя
    - `clearError()` - Очистка ошибок 
  - **Состояния**:
    - `user` - Информация о пользователе 
    - `profile` - Расширенные данные профиля
    - `token` - Токен аутентификации
    - `isLoading` - Состояние загрузки
    - `error` - Текст ошибки, если есть

### Компоненты форм аутентификации
- `src/components/auth/login-form.tsx` - Компонент формы входа с обработкой состояний и ошибок
- `src/components/auth/register-form.tsx` - Компонент формы регистрации
- `src/components/auth/activate-form.tsx` - Компонент формы активации аккаунта

### Провайдеры контекста
- `src/providers/auth-provider.tsx` - Провайдер контекста аутентификации для приложения с методами и состояниями:
  - **Публичные методы**:
    - `login()` - Вход в систему
    - `register()` - Регистрация
    - `logout()` - Выход
    - `activateAccount()` - Активация
    - `clearError()` - Очистка ошибок
    - `fetchProfile()` - Получение профиля
  - **Вычисляемые свойства**:
    - `isAuthenticated` - Статус аутентификации
    - `isAdmin` - Признак администратора
    - `isGuest` - Признак гостя
 
### Страницы, связанные с аутентификацией
- `src/app/login/page.tsx` - Страница входа
- `src/app/register/page.tsx` - Страница регистрации
- `src/app/profile/page.tsx` - Страница профиля пользователя с управлением аккаунтом

### Маршрутизация и API
- `src/app/api/trpc/[trpc]/route.ts` - Обработчик tRPC запросов
- `src/server/routers/auth.ts` - Реализация tRPC API для аутентификации

### Провайдеры

- **AuthProvider**: Управление состоянием аутентификации и предоставление информации о пользователе
- **ThemeProvider**: Управление темой оформления (светлая/темная)

### API маршрутизаторы

- **authRouter**: Обработка запросов аутентификации, регистрации и управления пользователями
