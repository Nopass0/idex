# Структура проекта

```
idex/
├── src/                          # Исходный код приложения
│   ├── app/                      # Файлы маршрутизации и страницы Next.js
│   │   ├── admin/                # Административный раздел
│   │   │   ├── client-providers.tsx  # Клиентские провайдеры для админ-панели
│   │   │   ├── layout.tsx          # Серверный компонент с верхней навигацией для админ-панели
│   │   │   ├── navigation-blocker.tsx # Компонент для блокировки доступа неавторизованным пользователям
│   │   │   ├── components/       # Компоненты админ-панели
│   │   │   │   ├── keys-manager.tsx  # Компонент для управления ключами активации
│   │   │   │   ├── users-list.tsx    # Компонент для отображения списка пользователей
│   │   │   │   ├── settings-manager.tsx # Управление настройками системы
│   │   │   │   └── transactions-manager.tsx # Компонент для управления транзакциями, включая функции создания, редактирования и просмотра
│   │   │   ├── users/            # Управление пользователями (отдельная страница)
│   │   │   │   └── page.tsx      # Страница управления пользователями с графиками и фильтрацией
│   │   │   ├── keys/             # Управление ключами активации (отдельная страница)
│   │   │   │   └── page.tsx      # Страница управления ключами активации
│   │   │   ├── settings/         # Настройки системы (отдельная страница)
│   │   │   │   └── page.tsx      # Страница настроек системы
│   │   │   └── page.tsx          # Главная страница админ-панели с единым интерфейсом и переключением разделов
│   │   ├── auth/                # Страницы аутентификации
│   │   ├── dashboard/           # Пользовательская панель управления
│   │   ├── devices/              # Раздел устройств
│   │   │   └── page.tsx          # Страница устройств с поиском и фильтрацией
│   │   ├── profile/              # Раздел профиля пользователя
│   │   │   └── page.tsx          # Страница профиля пользователя
│   │   ├── withdrawals/          # Раздел управления выводами средств и транзакциями
│   │   │   └── page.tsx          # Страница просмотра и управления транзакциями с фильтрацией и модальными окнами для подтверждения/отклонения
│   │   ├── layout.tsx            # Основной лейаут с HeroUIProvider
│   │   └── page.tsx              # Главная страница
│   ├── components/               # Переиспользуемые компоненты
│   │   ├── navigation.tsx        # Компонент навигации с обработкой аутентификации
│   │   └── ..другие компоненты
│   ├── lib/                      # Вспомогательные библиотеки и утилиты
│   │   ├── stores/               # Хранилища состояния (Zustand)
│   │   │   ├── auth-store.ts     # Хранилище для аутентификации
│   │   │   └── ..другие хранилища
│   │   ├── schemas/              # Схемы данных и валидации
│   │   ├── api/                  # API клиенты и интеграции
│   │   ├── utils/                # Вспомогательные функции
│   │   │   ├── avatar-generator.ts # Генератор аватарок в стиле Apple Watch
│   │   └── hooks/                # Пользовательские хуки
│   ├── server/                   # Серверный код
│   │   ├── api/                  # API эндпоинты
│   │   │   ├── routers/          # TRPC роутеры
│   │   │   │   ├── user.ts       # API-маршрутизатор для управления пользователями и ключами активации
│   │   │   │   ├── transaction.ts # API-маршрутизатор для управления транзакциями (получение, создание, подтверждение, отклонение)
│   │   │   │   └── ..другие роутеры
│   │   │   └── trpc.ts           # Настройка TRPC
│   │   ├── auth/                 # Функции аутентификации
│   │   ├── db/                   # Функции для работы с базой данных
│   │   └── ..другие серверные файлы
│   ├── styles/                   # Глобальные стили
│   └── ..другие папки и файлы
├── prisma/                       # Схемы и миграции Prisma
├── public/                       # Статические файлы
└── project/                      # Документация проекта
    ├── history.md                # История изменений
    ├── structure.md              # Структура проекта (этот файл)
    ├── tech.md                   # Технологический стек
    └── requests.md               # Архив запросов пользователя

## Описание ключевых компонентов

### app/layout.tsx
Основной шаблон приложения, который оборачивает все страницы. Включает:
- HeroUIProvider для интеграции с библиотекой @heroui/react
- Глобальные стили
- Компонент навигации
- Провайдеры для React Query и других библиотек

### components/navigation.tsx
Навигационный компонент, который отображается на всех страницах. Основные функции:
- Отображение меню навигации для авторизованных и неавторизованных пользователей
- Выпадающее меню пользователя с информацией о балансе
- Модальное окно для пополнения баланса
- Упрощенная структура меню без условной логики для предотвращения ошибок HeroUI
- Адаптивный дизайн для мобильных устройств

### lib/stores/auth-store.ts
Хранилище состояния аутентификации на основе Zustand. Функции:
- Хранение информации о текущем пользователе
- Методы для входа и выхода из системы
- Хранение и обновление токена
- Проверка аутентификации пользователя

### lib/utils/avatar-generator.ts
Улучшенный генератор аватарок в стиле Apple Watch на основе имени и логина пользователя. Особенности:
- Генерация SVG-аватарок с интерактивными кольцами активности
- Поддержка трех стилей отображения: темный, светлый и цветной
- Декоративные элементы, выбираемые на основе имени пользователя (точки, линии, звездочки и др.)
- SVG-фильтры для создания эффекта свечения колец
- Полная типизация и обработка потенциально неопределенных значений для повышения надежности
- Возвращение как самого SVG-изображения, так и метаданных аватарки

### server/api/routers/user.ts
API-маршрутизатор для управления пользователями и ключами активации, включая методы получения всех ключей и массового создания ключей.

### server/api/routers/transaction.ts
API-маршрутизатор для управления транзакциями, включая методы получения, создания, подтверждения и отклонения транзакций.

## Важные технические решения
1. Для аутентификации используется связка JWT + Zustand store
2. Для UI используется библиотека @heroui/react с учетом ограничений в работе коллекций
3. Для серверного API используется tRPC
4. В качестве ORM используется Prisma
5. Стилизация компонентов с использованием Tailwind CSS
6. Типизация с использованием TypeScript для предотвращения ошибок во время компиляции

### Типы (TypeScript)

- **transaction.ts**: Типы для работы с транзакциями
  - `TransactionStatus`: Перечисление статусов транзакции
  - `ITransaction`: Интерфейс транзакции
  - `IReceipt`: Интерфейс чека
  - `ITransactionsData`: Интерфейс данных о транзакциях
